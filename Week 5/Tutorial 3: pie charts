#goal : We want a summary table with 4 rows for the types of natural disasters (Drought, Storm, Landslide, Flood) and the total deaths per disaster type
from pathlib import Path
import csv

csv_path = Path('/Users/evelyngordi/Downloads/EMDAT_Haiti_Disaster_Deaths_By_Year.csv')

#creating the summarization dictionary

disastertype_by_totaldeaths_dicts = {}
with open(csv_path, 'r', encoding = 'cp1252') as csv_file:
    reader = csv.reader(csv_file)
    headers = next(reader)

    for row in reader:
        country, year, subgroup, disaster_type, total_deaths, injured_count, total_affected = row #telling python what each of the rows contain

        if not total_deaths:
            total_deaths = 0
        else: total_deaths = int(total_deaths.replace(',', ''))

        if disaster_type not in disastertype_by_totaldeaths_dicts: #if disaster type is not yet in the dictionary
            disastertype_by_totaldeaths_dicts[disaster_type ] = [total_deaths] #add it to the dictionary and stpre the total deaths as the value for disaster_type key

        else: 
            disastertype_by_totaldeaths_dicts[disaster_type].append(total_deaths) #if disaster type already exists, it appends (adds) the next total_deaths value to the same key

#exporting the summarization into a new table
summary_headers = ['Disaster Type', 'Total Deaths']
summary_table = []

for disaster_type in disastertype_by_totaldeaths_dicts: #iterate across the dictionary to get each distaster type and their corresponding list of deaths, which we have in the dictionary already
    total_deaths_by_disaster_list = disastertype_by_totaldeaths_dicts[disaster_type]
    total_deaths_for_type = sum(total_deaths_by_disaster_list)
    summary_table.append([disaster_type, total_deaths_for_type])

output_path = Path('/Users/evelyngordi/Downloads/put_data_here.csv')
with open(output_path,'w', newline='', encoding='cp1252') as f:
    writer = csv.writer(f)
    writer.writerows([summary_headers] + summary_table)
